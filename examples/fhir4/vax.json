{
    "@context": {"ls": "https://lschema.org/"},
    "@type": "ls:Schema",
    "@id": "http://example.org/TestTarget",
    "ls:layer": {
        "@type": ["ls:Object","http://example.org/TargetType"],
        "ls:Object#attributes": [
            {
                "@id": "https://www.w3.org/2018/credentials/v1/name",
                "@type": "ls:Value",
                "ls:reshape#source": "'COVID-19 Vaccination Certificate'"
            },
            {
                "@id":"https://www.w3.org/2018/credentials/v1/credentialSubject",
                "@type": "ls:Object",
                "ls:reshape#vars": [
                    "immunization:=source.firstReachable(node->(node.type.hasAll('http://hl7.org/fhir/Immunization','https://lschema.org/DocumentNode')))",
                    "patient:=source.firstReachable(node->(node.type.hasAll('http://hl7.org/fhir/Patient','https://lschema.org/DocumentNode')))"
                ],
                "ls:Object#attributes": [
                    {
                        "@id": "https://w3id.org/vaccination#batchNumber",
                        "@type": "ls:Value",
                        "ls:reshape#source": "immunization.firstReachable(node->(node.instanceOf('http://hl7.org/fhir/Immunization#lotNumber')))"
                    },
                    {
                        "@id": "https://w3id.org/vaccination#recipient",
                        "@type": "ls:Object",
                        "ls:Object#attributes": [
                            {
                                "@id": "http://schema.org/givenName",
                                "@type": "ls:Value",
                                "ls:reshape#source": "patient.firstReachable(node->(node.instanceOf('http://hl7.org/fhir/HumanName#given'))).walk('https://lschema.org/data/array#elements')"
                            },
                            {
                                "@id": "http://schema.org/familyName",
                                "@type": "ls:Value",
                                "ls:reshape#source": "patient.firstReachable(node->(node.instanceOf('http://hl7.org/fhir/HumanName#family')))"
                            },
                            {
                                "@id": "http://schema.org/gender",
                                "@type": "ls:Value",
                                "ls:reshape#source": "patient.firstReachable(node->(node.instanceOf('http://hl7.org/fhir/Patient#gender')))"
                            },
                            {
                                "@id": "http://schema.org/birthDate",
                                "@type": "ls:Value",
                                "ls:reshape#source": "patient.firstReachable(node->(node.instanceOf('http://hl7.org/fhir/Patient#birthDate')))"
                            }
                        ]
                    }
                ]
            }
        ]
    }
}
